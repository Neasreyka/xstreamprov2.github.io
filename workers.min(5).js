(()=>{"use strict";var e={563:(e,t)=>{class s extends Error{status;constructor(e=500,t){super("object"==typeof t?t.error:t),"object"==typeof t&&Object.assign(this,t),this.status=e}}const o=(e="text/plain; charset=utf-8",t)=>(s,o)=>{const{headers:a={},...n}=o||{};return"Response"===s?.constructor.name?s:new Response(t?t(s):s,{headers:{"content-type":e,...a},...n})},a=o("application/json; charset=utf-8",JSON.stringify),n=e=>({400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error"}[e]||"Unknown Error"),r=o("text/html"),c=o("image/jpeg"),i=o("image/png"),d=o("image/webp");t.Router=({base:e="",routes:t=[]}={})=>({__proto__:new Proxy({},{get:(s,o,a,n)=>(s,...r)=>t.push([o.toUpperCase(),RegExp(`^${(n=(e+s).replace(/\/+(\/|$)/g,"$1")).replace(/(\/?\.?):(\w+)\+/g,"($1(?<$2>*))").replace(/(\/?\.?):(\w+)/g,"($1(?<$2>[^$1/]+?))").replace(/\./g,"\\.").replace(/(\/?)\*/g,"($1.*)?")}/*$`),r,n])&&a}),routes:t,async handle(e,...s){let o,a,n=new URL(e.url),r=e.query={__proto__:null};for(let[e,t]of n.searchParams)r[e]=void 0===r[e]?t:[r[e],t].flat();for(let[r,c,i,d]of t)if((r===e.method||"ALL"===r)&&(a=n.pathname.match(c))){e.params=a.groups||{},e.route=d;for(let t of i)if(void 0!==(o=await t(e.proxy||e,...s)))return o}}}),t.StatusError=s,t.createCors=(e={})=>{const{origins:t=["*"],maxAge:s,methods:o=["GET"],headers:a={}}=e;let n;const r={"content-type":"application/json","Access-Control-Allow-Methods":o.join(", "),...a};return s&&(r["Access-Control-Max-Age"]=s),{corsify:e=>{if(!e)throw new Error("No fetch handler responded and no upstream to proxy to specified.");const{headers:t,status:s,body:o}=e;return[101,301,302,308].includes(s)||t.get("access-control-allow-origin")?e:new Response(o,{status:s,headers:{...Object.fromEntries(t),...r,...n,"content-type":t.get("content-type")}})},preflight:e=>{const s=[...new Set(["OPTIONS",...o])],a=e.headers.get("origin")||"";if(n=(t.includes(a)||t.includes("*"))&&{"Access-Control-Allow-Origin":a},"OPTIONS"===e.method){const t={...r,"Access-Control-Allow-Methods":s.join(", "),"Access-Control-Allow-Headers":e.headers.get("Access-Control-Request-Headers"),...n};return new Response(null,{headers:e.headers.get("Origin")&&e.headers.get("Access-Control-Request-Method")&&e.headers.get("Access-Control-Request-Headers")?t:{Allow:s.join(", ")}})}}}},t.createResponse=o,t.error=(e=500,t)=>{if(e instanceof Error){const{message:s,...o}=e;e=e.status||500,t={error:s||n(e),...o}}return t={status:e,..."object"==typeof t?t:{error:t||n(e)}},a(t,{status:e})},t.html=r,t.jpeg=c,t.json=a,t.png=i,t.status=(e,t)=>new Response(null,{...t,status:e}),t.text=(e,t)=>new Response(e,t),t.webp=d,t.withContent=async e=>{e.headers.get("content-type")?.includes("json")&&(e.content=await e.json())},t.withCookies=e=>{e.cookies=(e.headers.get("Cookie")||"").split(/;\s*/).map((e=>e.split(/=(.+)/))).reduce(((e,[t,s])=>s?(e[t]=s,e):e),{})},t.withParams=e=>{e.proxy=new Proxy(e.proxy||e,{get:(t,s)=>{let o;return void 0!==(o=t[s])?o.bind?.(e)||o:t?.params?.[s]}})}},384:function(e,t,s){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=o(s(821)),n=o(s(293));t.default=async e=>{const{host:t}=e.params,{origin:s,referer:o,"user-agent":r,"cf-connecting-ip":c,"x-real-ip":i,"cf-ray":d,host:h}=Object.fromEntries(e.headers);try{if(!(o&&r&&c&&e.cf&&s&&i&&d))throw new Error;const h={doodstream:a.default,gofile:n.default},l=await h[t](e);return new Response(l,{headers:{"content-type":"application/json","Access-Control-Allow-Origin":"*"}})}catch(e){return new Response(JSON.stringify({status:!1}),{headers:{"Access-Control-Allow-Origin":"*","Content-type":"application/json"},status:403})}}},821:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=async e=>{try{const{id:t,host:s}=e.params,o=e.headers.get("User-Agent"),a=await fetch("https://connected.pages.dev/cookie.json"),{cookie:n}=await a.json(),r=await fetch(`https://doodstream.com/e/${t}`,{headers:{"User-Agent":o,Accept:"text/html","Accept-Language":"en-US",Connection:"keep-alive","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1",TE:"trailers",DNT:"1"}}),c=[...new Set(r.headers.getAll("Set-Cookie"))].slice(0,3).map((e=>`${e.split("=")[0]}=${e.split("=")[1].split(";")[0]}`)).join("; "),i=await fetch("https://check.ddos-guard.net/check.js",{headers:{"User-Agent":o,Accept:"*/*","Accept-Language":"en-US,en;q=0.5","Accept-Encoding":"gzip, deflate, br",Referer:"https://doodstream.com",Cookie:c,"Sec-Fetch-Dest":"script","Sec-Fetch-Mode":"no-cors","Sec-Fetch-Site":"cross-site"}}),d=(await i.text()).match(/'\/\.well-known\/ddos-guard\/id\/(.*?)'/)[1],h=await fetch(`https://doodstream.com/.well-known/ddos-guard/id/${d}`,{headers:{"User-Agent":o,Accept:"image/webp,*/*","Accept-Language":"en-US,en;q=0.5","Accept-Encoding":"gzip, deflate, br","Cache-Control":"no-cache",Referer:"https://doodstream.com",Cookie:c,"Sec-Fetch-Dest":"script","Sec-Fetch-Mode":"no-cors","Sec-Fetch-Site":"cross-site"}}),l=[...new Set(h.headers.getAll("Set-Cookie"))].slice(0,3).map((e=>`${e.split("=")[0]}=${e.split("=")[1].split(";")[0]}`)).join("; "),p=await fetch(`https://doodstream.com/e/${t}`,{headers:{"user-agent":o,referer:"https://doodstream.com",cookie:`${c}; ${l}; xfsts=${n}`}}),g=await p.text(),u=g.match(/\/pass_md5\/([^']+)'/)[1],f=u.match(/[A-z0-9]+$/gm)[0],m=u.match(/^[A-z0-9-]+/gm)[0],w=await fetch(`https://doodstream.com/pass_md5/${u}`,{headers:{"user-agent":o,referer:"https://doodstream.com",cookie:`${c}; ${l}; xfsts=${n}`}}),y=await fetch(`https://doodstream.com/download/${f}/n/${m}`,{headers:{"user-agent":o,referer:"https://doodstream.com",cookie:`${c}; ${l}; xfsts=${n}`}}),A=(await y.text()).match(/https:\/\/[^\/]+\/[^\/]+\/[^\/]+\?token=[A-z0-9]+&expiry=[0-9]+/)[0],S=`${await w.text()}${function(e){for(var t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;10>o;o++)t+=s.charAt(Math.floor(62*Math.random()));return t+"?token="+e.match(/\w+$/)+"&expiry="+Date.now()}(u.toString())}`,[$,v]=[g.match(/https:\/\/\S+\/splash\/[a-zA-Z0-9]+\.jpg/gm)[0],g.match(/\/\/\S+\/get_slides\/[a-zA-Z0-9]+\/[a-zA-Z0-9]+.jpg/gm)[0]],b={status:!0,sources:[{file:S,type:"video/mp4",label:"Original",download:A}],download:A,image:$,host:s,id:t,vtt:`https://${e.headers.get("host")}/vtt/${s}?url=https:${v}`};return JSON.stringify(b)}catch{return JSON.stringify({status:!1})}}},293:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=async e=>{try{const{id:t,host:s}=e.params,o=e.headers.get("User-Agent"),a=await fetch("https://api.gofile.io/createAccount",{headers:{"User-Agent":o,Authority:"api.gofile.io",Path:"/createAccount",Origin:"https://gofile.io",Host:"gofile.io",Accept:"text/html","Accept-Language":"en-US",Connection:"keep-alive","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1",TE:"trailers",DNT:"1"}}),n=await a.json(),r=await fetch(`https://api.gofile.io/getContent?contentId=${t}&token=${n.data.token}&websiteToken=7fd94ds12fds4`,{headers:{"User-Agent":o,Authority:"api.gofile.io",Path:"/createAccount",Origin:"https://gofile.io",Host:"gofile.io",Accept:"text/html","Accept-Language":"en-US",Connection:"keep-alive","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1",TE:"trailers",DNT:"1"}}),c=await r.json(),i=c.data.childs;let d="jwplayer";const h={status:!0,playlist:i.map((t=>{const o=`https://${e.headers.get("host")}/play/${s}?url=`+btoa(`${c.data.contents[t].link}?token=${n.data.token}`);return"video/x-matroska"==c.data.contents[t].mimetype&&(d="plyr"),{file:o,type:`${c.data.contents[t].mimetype}`,image:`https://cdn.statically.io/og/${c.data.contents[t].name}.jpg`}})),host:s,id:t,player:d};return JSON.stringify(h)}catch{return JSON.stringify({status:!1})}}},244:function(e,t,s){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleRequest=void 0;const a=s(563),n=o(s(82)),r=o(s(424)),c=o(s(384)),i=o(s(279));t.handleRequest=(0,a.Router)().get("/api/:host/:id",c.default).get("/play/:host",i.default).get("/vtt/:host",n.default).get("/favicon.ico",r.default).get("*",(()=>new Response(JSON.stringify({status:!0,name:"XStreamPro REST API",description:"API to grab streaming links from external hosts",madeBy:"delivrjs",github:{profile:"https://github.com/delivrjs",repo:"https://github.com/delivrjs/XStreamPro-Player"}}),{status:200}))).handle},82:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=async e=>{const{host:t}=e.params,{url:s}=e.query;if("doodstream"==t){const e=(await(await fetch(s)).text()).replace(/slides/g,"https://img.dood.stream/slides");return new Response(e,{headers:{"content-type":"text/vtt","Access-Control-Allow-Origin":"*"}})}}},424:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=async()=>{const e=await fetch("https://i.imgur.com/aMCrl2k.png");return new Response(await e.blob(),{headers:{"cache-control":"max-age=604800"}})}},279:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=async e=>{try{const{host:s}=e.params,{url:o,f:a}=e.query,n=e.headers.get("User-Agent");if("gofile"==s){const s=atob(o).match(/[A-z0-9]+$/gm)[0];var t=atob(o).split("?")[0];if("download"==a){const e=await fetch(`${t}`,{headers:{Accept:"*/*","accept-encoding":"identity;q=1, *;q=0","Accept-Language":"en-GB,en-US;q=0.9,en;q=0.8,hi;q=0.7,fr;q=0.6",Cookie:`accountToken=${s}`,DNT:"1","Sec-Fetch-Dest":"video","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","sec-gpc":"1","User-Agent":n}});return new Response(e.body,e)}{const o=await fetch(`${t}`,{headers:{Accept:"*/*","accept-encoding":"identity;q=1, *;q=0","Accept-Language":"en-GB,en-US;q=0.9,en;q=0.8,hi;q=0.7,fr;q=0.6",Cookie:`accountToken=${s}`,DNT:"1",Range:null!=e.headers.get("range")?e.headers.get("range"):"bytes=0-","Sec-Fetch-Dest":"video","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","sec-gpc":"1","User-Agent":n}});if(200==o.status){const o=await fetch(`${t}`,{headers:{Accept:"*/*","accept-encoding":"identity;q=1, *;q=0","Accept-Language":"en-GB,en-US;q=0.9,en;q=0.8,hi;q=0.7,fr;q=0.6",Cookie:`accountToken=${s}`,DNT:"1",Range:null!=e.headers.get("range")?e.headers.get("range"):"bytes=0-","Sec-Fetch-Dest":"video","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","sec-gpc":"1","User-Agent":n}}),a=new Response(o.body,o);return a.headers.set("Accept-Ranges","bytes"),a}const a=new Response(o.body,o);return a.headers.set("Accept-Ranges","bytes"),a}}}catch{return JSON.stringify({status:!1})}}}},t={};function s(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,s),n.exports}(()=>{const e=s(244);addEventListener("fetch",(t=>{t.respondWith((0,e.handleRequest)(t.request))}))})()})();