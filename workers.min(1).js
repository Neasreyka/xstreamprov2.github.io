(()=>{"use strict";var e={929:function(e,t,s){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=o(s(727));t.default=async e=>{const{host:t}=e.params,{origin:s,referer:o,"user-agent":n,"cf-connecting-ip":a,"x-real-ip":c,"cf-ray":i,host:d}=Object.fromEntries(e.headers);try{if(!(o&&n&&a&&e.cf&&s&&c&&i))throw new Error;const d={doodstream:r.default},l=await d[t](e);return new Response(l,{headers:{"content-type":"application/json","Access-Control-Allow-Origin":"*"}})}catch(e){return new Response(JSON.stringify({status:!1}),{headers:{"Access-Control-Allow-Origin":"*","Content-type":"application/json"},status:403})}}},727:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=async e=>{try{const{id:t,host:s}=e.params,o=e.headers.get("User-Agent"),r=await fetch("https://connected.pages.dev/cookie.json"),{cookie:n}=await r.json(),a=await fetch(`https://doodstream.com/e/${t}`,{headers:{"User-Agent":o,Accept:"text/html","Accept-Language":"en-US",Connection:"keep-alive","Sec-Fetch-Dest":"document","Sec-Fetch-Mode":"navigate","Sec-Fetch-Site":"none","Sec-Fetch-User":"?1",TE:"trailers",DNT:"1"}}),c=[...new Set(a.headers.getAll("Set-Cookie"))].slice(0,3).map((e=>`${e.split("=")[0]}=${e.split("=")[1].split(";")[0]}`)).join("; "),i=await fetch("https://check.ddos-guard.net/check.js",{headers:{"User-Agent":o,Accept:"*/*","Accept-Language":"en-US,en;q=0.5","Accept-Encoding":"gzip, deflate, br",Referer:"https://doodstream.com",Cookie:c,"Sec-Fetch-Dest":"script","Sec-Fetch-Mode":"no-cors","Sec-Fetch-Site":"cross-site"}}),d=(await i.text()).match(/'\/\.well-known\/ddos-guard\/id\/(.*?)'/)[1],l=await fetch(`https://doodstream.com/.well-known/ddos-guard/id/${d}`,{headers:{"User-Agent":o,Accept:"image/webp,*/*","Accept-Language":"en-US,en;q=0.5","Accept-Encoding":"gzip, deflate, br","Cache-Control":"no-cache",Referer:"https://doodstream.com",Cookie:c,"Sec-Fetch-Dest":"script","Sec-Fetch-Mode":"no-cors","Sec-Fetch-Site":"cross-site"}}),p=[...new Set(l.headers.getAll("Set-Cookie"))].slice(0,3).map((e=>`${e.split("=")[0]}=${e.split("=")[1].split(";")[0]}`)).join("; "),h=await fetch(`https://doodstream.com/e/${t}`,{headers:{"user-agent":o,referer:"https://doodstream.com",cookie:`${c}; ${p}; xfsts=${n}`}}),u=await h.text(),g=u.match(/\/pass_md5\/([^']+)'/)[1],f=await fetch(`https://doodstream.com/pass_md5/${g}`,{headers:{"user-agent":o,referer:"https://doodstream.com",cookie:`${c}; ${p}; xfsts=${n}`}}),m=`${await f.text()}${function(e){for(var t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;10>o;o++)t+=s.charAt(Math.floor(62*Math.random()));return t+"?token="+e.match(/\w+$/)+"&expiry="+Date.now()}(g.toString())}`,[w,y]=[u.match(/https:\/\/\S+\/splash\/[a-zA-Z0-9]+\.jpg/gm)[0],u.match(/\/\/\S+\/get_slides\/[a-zA-Z0-9]+\/[a-zA-Z0-9]+.jpg/gm)[0]],A={status:!0,sources:[{file:m,type:"video/mp4",label:"Original"}],image:w,host:s,id:t,vtt:`https://${e.headers.get("host")}/vtt/${s}?url=https:${y}`};return JSON.stringify(A)}catch{return JSON.stringify({status:!1})}}},71:function(e,t,s){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleRequest=void 0;const r=s(35),n=o(s(929)),a=o(s(964)),c=o(s(710));t.handleRequest=(0,r.Router)().get("/api/:host/:id",n.default).get("/vtt/:host",a.default).get("/favicon.ico",c.default).get("*",(()=>new Response(JSON.stringify({status:!0,name:"XStreamPro REST API",description:"API to grab streaming links from external hosts",madeBy:"delivrjs",github:{profile:"https://github.com/delivrjs",repo:"https://github.com/delivrjs/XStreamPro-Player"}}),{status:200}))).handle},964:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=async e=>{const{host:t}=e.params,{url:s}=e.query;if("doodstream"==t){const e=(await(await fetch(s)).text()).replace(/slides/g,"https://img.dood.stream/slides");return new Response(e,{headers:{"content-type":"text/vtt","Access-Control-Allow-Origin":"*"}})}}},710:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=async()=>{const e=await fetch("https://i.imgur.com/aMCrl2k.png");return new Response(await e.blob(),{headers:{"cache-control":"max-age=604800"}})}},35:(e,t,s)=>{s.r(t),s.d(t,{Router:()=>o,StatusError:()=>r,createCors:()=>y,createResponse:()=>n,error:()=>i,html:()=>p,jpeg:()=>h,json:()=>a,png:()=>u,status:()=>d,text:()=>l,webp:()=>g,withContent:()=>f,withCookies:()=>m,withParams:()=>w});const o=({base:e="",routes:t=[]}={})=>({__proto__:new Proxy({},{get:(s,o,r,n)=>(s,...a)=>t.push([o.toUpperCase(),RegExp(`^${(n=(e+"/"+s).replace(/\/+(\/|$)/g,"$1")).replace(/(\/?\.?):(\w+)\+/g,"($1(?<$2>*))").replace(/(\/?\.?):(\w+)/g,"($1(?<$2>[^$1/]+?))").replace(/\./g,"\\.").replace(/(\/?)\*/g,"($1.*)?")}/*$`),a,n])&&r}),routes:t,async handle(e,...s){let o,r,n=new URL(e.url),a=e.query={__proto__:null};for(let[e,t]of n.searchParams)a[e]=void 0===a[e]?t:[a[e],t].flat();for(let[a,c,i,d]of t)if((a===e.method||"ALL"===a)&&(r=n.pathname.match(c))){e.params=r.groups||{},e.route=d;for(let t of i)if(void 0!==(o=await t(e.proxy||e,...s)))return o}}});class r extends Error{status;constructor(e=500,t){super("object"==typeof t?t.error:t),"object"==typeof t&&Object.assign(this,t),this.status=e}}const n=(e="text/plain; charset=utf-8",t)=>(s,o={})=>{const{headers:r={},...n}=o;return"Response"===s?.constructor.name?s:new Response(t?t(s):s,{headers:{"content-type":e,...r},...n})},a=n("application/json; charset=utf-8",JSON.stringify),c=e=>({400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error"}[e]||"Unknown Error"),i=(e=500,t)=>{if(e instanceof Error){const{message:s,...o}=e;e=e.status||500,t={error:s||c(e),...o}}return t={status:e,..."object"==typeof t?t:{error:t||c(e)}},a(t,{status:e})},d=e=>new Response(null,{status:e}),l=(e,t)=>new Response(e,t),p=n("text/html"),h=n("image/jpeg"),u=n("image/png"),g=n("image/webp"),f=async e=>{e.headers.get("content-type")?.includes("json")&&(e.content=await e.json())},m=e=>{e.cookies=(e.headers.get("Cookie")||"").split(/;\s*/).map((e=>e.split(/=(.+)/))).reduce(((e,[t,s])=>s?(e[t]=s,e):e),{})},w=e=>{e.proxy=new Proxy(e.proxy||e,{get:(t,s)=>{let o;return void 0!==(o=t[s])?o.bind?.(e)||o:t?.params?.[s]}})},y=(e={})=>{const{origins:t=["*"],maxAge:s,methods:o=["GET"],headers:r={}}=e;let n;const a={"content-type":"application/json","Access-Control-Allow-Methods":o.join(", "),...r};return s&&(a["Access-Control-Max-Age"]=s),{corsify:e=>{if(!e)throw new Error("No fetch handler responded and no upstream to proxy to specified.");const{headers:t,status:s,body:o}=e;return[101,301,302,308].includes(s)||t.get("access-control-allow-origin")?e:new Response(o,{status:s,headers:{...Object.fromEntries(t),...a,...n,"content-type":t.get("content-type")}})},preflight:e=>{const s=[...new Set(["OPTIONS",...o])],r=e.headers.get("origin")||"";if(n=(t.includes(r)||t.includes("*"))&&{"Access-Control-Allow-Origin":r},"OPTIONS"===e.method){const t={...a,"Access-Control-Allow-Methods":s.join(", "),"Access-Control-Allow-Headers":e.headers.get("Access-Control-Request-Headers"),...n};return new Response(null,{headers:e.headers.get("Origin")&&e.headers.get("Access-Control-Request-Method")&&e.headers.get("Access-Control-Request-Headers")?t:{Allow:s.join(", ")}})}}}}}},t={};function s(o){var r=t[o];if(void 0!==r)return r.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,s),n.exports}s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=s(71);addEventListener("fetch",(t=>{t.respondWith((0,e.handleRequest)(t.request))}))})()})();